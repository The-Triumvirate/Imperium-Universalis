namespace = startup

########################################################################################
# startup
########################################################################################
country_event = {
	id = startup.1
	title = "startup.1.t"
	desc = "startup.1.d"
	picture = culture

	is_triggered_only = yes
	hidden = yes
	fire_only_once = yes

	trigger = {
		ai = no
	}

	immediate = {
		#One time only scripted effects
		iu_initialize_schools_effect = yes
		initialize_chinese_schools_effect = yes
		initialize_polis_modifiers = yes
		initialize_media_modifiers = yes
		set_wonder_flags_start_effect = yes
		upgrade_great_project_history_effect = yes
		sub_roman_core_cleanup_effect = yes
		#################################
		set_global_flag = game_start_flag
		# Popgrowth
		set_global_flag = popgrowth_vanilla
		set_global_flag = coloredvassals_ai_yes
		country_event = { id = startup.9 days = 7 }	# makes railroading impossible

		every_country = {
			# Institutions
			if = {
				limit = { NOT = { has_institution = writing_system } }
				add_country_modifier = {
					name = illiterate_country_modifier
					duration = -1
				}
			}
			if = {
				limit = { NOT = { has_institution = iron_age } }
				add_country_modifier = {
					name = bronze_age_modifier
					duration = -1
				}
			}

			# Estates
			if = {
				limit = {
					has_estate = estate_priesthood
					has_estate = estate_merchants
					has_estate = estate_nobility
				}
				change_estate_land_share = {
					estate = estate_priesthood
					share = -6
				}
				change_estate_land_share = {
					estate = estate_merchants
					share = -3
				}
				change_estate_land_share = {
					estate = estate_nobility
					share = 22
				}
			}
			else_if = {
				limit = { has_estate = estate_clans }
				change_estate_land_share = {
					estate = estate_clans
					share = 20
				}
			}

			# Slavery
			export_to_variable = { which = slaves value = total_development }
			# effect of total development: 30% to 10% total value
			trigger_switch = {
				on_trigger = total_development
				1000 = { multiply_variable = { slaves = 1.01 } } # 10%
				500 = { multiply_variable = { slaves = 1.2 } }
				200 = { multiply_variable = { slaves = 1.5 } }	# 15%: 250 dev = 2.500.000 population x 15% = 375.000. 250 x 1.5 = 375 (thousand). OK
				100 = { multiply_variable = { slaves = 1.8 } }
				50 = { multiply_variable = { slaves = 2.5 }	}
				10 = { multiply_variable = { slaves = 3.0 }	}
				1 = { multiply_variable = { slaves = 3.5 } }	# 4 dev = 40.000 population x 35% = 14000. 4 x 3.5 = 14. OK
			}
			set_country_flag = SD_priv_recent_change		# updater for privileges

			# Assign slave types by government type. Values: Native -60%, Tribal -30%, Republics -10%, Oligarchy 0%, Monarchy +10%
			trigger_switch = {
				on_trigger = government
				native = { 			# shouldn't have slaves estate, anyway
					multiply_variable = { slaves = 0.4 }
					set_estate_privilege = estate_slaves_status_1 	# war captives
					set_estate_privilege = estate_slaves_jobs_1		# farming and mining
				}
				tribal = { 			# shouldn't have slaves estate, anyway
					multiply_variable = { slaves = 0.7 }
					set_estate_privilege = estate_slaves_status_1 	# war captives
					set_estate_privilege = estate_slaves_jobs_1		# farming and mining
				}
				republic = {
					multiply_variable = { slaves = 0.9 }
					set_estate_privilege = estate_slaves_status_3 	# normal type
					set_estate_privilege = estate_slaves_jobs_2		# normal use
				}
				theocracy = { 	# oligarchy
					set_estate_privilege = estate_slaves_status_3 	# normal type
					set_estate_privilege = estate_slaves_jobs_1		# farming and mining
				}
				monarchy = {
					multiply_variable = { slaves = 1.10 }
					set_estate_privilege = estate_slaves_status_2 	# serfdom
					set_estate_privilege = estate_slaves_jobs_1		# farming and mining
				}

			}
			set_estate_privilege = estate_slaves_condition_3		# 3 is normal. Ranges from 1 to 7
			change_estate_land_share = { estate = estate_slaves share = -100 }

			every_owned_province = {
				limit = { SD_slavesprod_check = yes }
				SD_update_provslots = yes
			}

			# Coronation
			limit = {
				government = monarchy
				has_consort_regency = no
				has_regency = no
			}
			add_ruler_modifier = { name = coronation_decent }
			set_ruler_flag = ruler_coronation
		}

		# Flag, to remove naval forcelimit from inland provinces, and -50% in "river ports"
		PG_add_river_ports = yes
	}

	option = {
		name = "startup.1.a"
	}
}

country_event = {
	id = startup.4
	title = "startup.4.t"
	desc = "startup.4.d"
	picture = culture
	fire_only_once = yes
	is_triggered_only = yes

	trigger = { ai = no }

	option = {
		name = "startup.4.a" #literally does nothing, does not enable admin stress
	}

	option = {
		name = "startup.4.c" #permanently disable admin stress for this save
		hidden_effect = {
			set_global_flag = easy_ride

			every_country = {
				remove_administrative_stress_modifiers = yes
				remove_border_garrisons_modifiers = yes
				remove_inefficient_land_organization_modifiers = yes
			}
		}
	}
}

#Adds flag for historical winners
country_event = {
	id = startup.5
	title = "startup.5.t"
	desc = "startup.5.d"
	picture = culture

	fire_only_once = yes
	is_triggered_only = yes

	option = {
		name = "startup.5.a"
		hidden_effect = { set_global_flag = historical_winners_modifier_flag }
	}
	option = {
		name = "startup.5.b"
	}
}

#Localized or Common English names
country_event = {
	id = startup.6
	title = "startup.6.t"
	desc = "startup.6.d"
	picture = culture

	fire_only_once = yes
	is_triggered_only = yes

	option = {
		name = "startup.6.a"
	}
	option = {
		name = "startup.6.b"
		hidden_effect = { override_country_names_start_effect = yes }
	}
}


#Changes estate land arrangement
country_event = {
	id = startup.7
	title = "startup.6.t"
	desc = "startup.6.d"
	picture = culture

	hidden = yes
	fire_only_once = yes
	is_triggered_only = yes

	option = {
		name = "startup.6.a"
		if = {
			limit = {
				NOT = { has_estate = estate_clans }
				has_estate = estate_priesthood
				has_estate = estate_merchants
				has_estate = estate_nobility
			}
			change_estate_land_share = {
				estate = estate_priesthood
				share = -7
			}
			change_estate_land_share = {
				estate = estate_merchants
				share = -4
			}
			change_estate_land_share = {
				estate = estate_nobility
				share = 22
			}
		}
		else_if = {
			limit = { has_estate = estate_clans }
			change_estate_land_share = {
				estate = estate_clans
				share = 30
			}
		}
	}
}
country_event = {
	id = startup.8
	title = "startup.8.t"
	desc = "startup.8.d"
	picture = helper

	fire_only_once = yes

	trigger = {
		ai = no
		started_in = 200.1.1
	}

	immediate = {
		#One time only scripted effects
		hidden_effect = {
			add_bookmark_help_modifier = yes
		}
	}

	option = {
		name = "startup.8.a"
		add_years_of_income = 2
	}
}

country_event = {
	id = startup.9
	title = "startup.8.t"
	desc = "startup.8.d"
	picture = helper

	fire_only_once = yes
	is_triggered_only = yes
	hidden = yes

	immediate = {
		#Week has passed
		set_global_flag = week_passed_start
	}

	option = {
		name = "startup.8.a"
	}
}